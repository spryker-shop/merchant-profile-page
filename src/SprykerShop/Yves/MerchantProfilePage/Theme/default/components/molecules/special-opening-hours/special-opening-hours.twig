{% extends model('component') %}

{% define config = {
    name: 'special-opening-hours',
} %}

{% define data = {
    specialOpeningHours: required
} %}
{% block body %}
    {% if data.specialOpeningHours is not empty %}
        {% block title %}
        <strong>{{ 'merchant_opening_hours.special_opening_hours_title' | trans }}</strong><br>
        {% endblock %}
        {% set prevDate = '' %}
        {% set todayTimestamp = "now" | date('Y-m-d') | date('U') %}
        {% set openingHoursCounter = 0 %}
        {% set openingHoursLimit = 2 %}
        {% for openingHours in data.specialOpeningHours %}
            {% if openingHours.timeFrom is not empty and openingHours.timeFrom is not empty %}
                {% set dateTimestamp = (openingHours.date ~ ' ' ~ openingHours.timeFrom) | date('U') %}
                {% if dateTimestamp >= todayTimestamp and openingHoursCounter < openingHoursLimit %}
                    {% set openingHoursCounter = openingHoursCounter + 1 %}
                    {% block specialOpeningHours %}
                        {% if openingHours.date != prevDate %}
                            {{ openingHours.date | date('d.m.Y, l') }}
                            {% if openingHours.note is not empty %}
                            ({{ openingHours.note | trans }})
                            {%  endif %}
                            {% set prevDate = openingHours.date %}
                        {% else %}
                            |
                        {% endif %}
                        {{ openingHours.timeFrom | date('H:i') }} - {{ openingHours.timeTo | date('H:i') }}
                        <br>
                    {% endblock %}
                {% endif %}
            {% endif %}
        {% endfor %}
    {% endif %}
{% endblock %}
